global:
  scrape_interval: 10s
  evaluation_interval: 10s

scrape_configs:
  - job_name: "flask-app"
    static_configs:
      - targets: ["app:5000"]

  - job_name: "node"
    static_configs:
      # node-exporter exposes on host network; Prometheus container can't reach host by "localhost".
      # Replace with actual EC2 private IP or 127.0.0.1 accessible via network_mode host? We'll target host:9100 from host firewall.
      - targets: ["host.docker.internal:9100"]
    tls_config:
      insecure_skip_verify: true
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: "ec2-host"

  - job_name: "pushgateway"
    honor_labels: true
    static_configs:
      - targets: ["pushgateway:9091"]
